<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://www.gengjf.com">
  <title>iOS数据采集 | Gengjf</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="数据采集当数据量大于2048，采用POST方式，否则使用GET。
###一、Header必传数据：
应用信息：


_app_version     // 应用版本号
_app_build          // 应用编译版本号
_build_uuid         // 编译UUID


SDK信息：


app_key=1234  // 应用key，从平台配置后获取
device_id=e9">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS数据采集">
<meta property="og:url" content="http://www.gengjf.com/2016/11/08/iOS数据采集/index.html">
<meta property="og:site_name" content="Gengjf">
<meta property="og:description" content="数据采集当数据量大于2048，采用POST方式，否则使用GET。
###一、Header必传数据：
应用信息：


_app_version     // 应用版本号
_app_build          // 应用编译版本号
_build_uuid         // 编译UUID


SDK信息：


app_key=1234  // 应用key，从平台配置后获取
device_id=e9">
<meta property="og:updated_time" content="2016-11-08T05:28:33.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOS数据采集">
<meta name="twitter:description" content="数据采集当数据量大于2048，采用POST方式，否则使用GET。
###一、Header必传数据：
应用信息：


_app_version     // 应用版本号
_app_build          // 应用编译版本号
_build_uuid         // 编译UUID


SDK信息：


app_key=1234  // 应用key，从平台配置后获取
device_id=e9">
  
    <link rel="alternative" href="/atom.xml" title="Gengjf" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/main.css">
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Gengjf</a></h1>
		</hgroup>

		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/随笔">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Gengjf</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="/avatar.png" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Gengjf</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/tags/随笔">随笔</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        <article id="post-iOS数据采集" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      iOS数据采集
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数据采集"><a href="#数据采集" class="headerlink" title="数据采集"></a>数据采集</h1><p>当数据量大于2048，采用POST方式，否则使用GET。</p>
<p>###一、Header必传数据：</p>
<p>应用信息：</p>
<blockquote>
<ul>
<li><strong>_app_version</strong>     // 应用版本号</li>
<li><strong>_app_build</strong>          // 应用编译版本号</li>
<li><strong>_build_uuid</strong>         // 编译UUID</li>
</ul>
</blockquote>
<p>SDK信息：</p>
<blockquote>
<ul>
<li><strong>app_key=1234</strong>  // 应用key，从平台配置后获取</li>
<li><strong>device_id=e94e15469de2c0ca2cce04f3d23e3220e8bacc1b</strong>    // 设备唯一标示，由SDK自动生成</li>
<li><strong>timestamp=1476166743136</strong>        // 发送数据时的时间戳</li>
<li><strong>sdk_version=16.10.13</strong>    // SDK版本</li>
<li><strong>sdk_name=objc-native-ios</strong> // SDK名</li>
</ul>
</blockquote>
<p>设备信息：</p>
<blockquote>
<ul>
<li><strong>_os</strong>                   // 系统名</li>
<li><strong>_os_version</strong>        // 系统版本</li>
<li><strong>_device</strong>            // 设备型号</li>
<li><strong>_resolution</strong>        // 分辨率</li>
<li><strong>_carrier</strong>            // 运营商</li>
<li><strong>_density</strong>            // 屏幕缩放比例</li>
<li><strong>_locale</strong>            // 系统语言</li>
<li>==<strong>_ip</strong>                  // 设备当前IP地址==</li>
<li>==<strong>_gps</strong>                 // 设备GPS经纬度，格式(latitude,longitude)==</li>
<li><strong>_cpu_current</strong>   // 当前的CPU使用率</li>
<li><strong>_ram_current</strong>     // 当前的ram空间</li>
<li><strong>_ram_total</strong>        // 设备ram总大小</li>
<li><strong>_disk_current</strong>    // 当前设备磁盘空间</li>
<li><strong>_disk_total</strong>        // 当前设备磁盘总大小</li>
<li><strong>_bat</strong>               // 设备电量</li>
<li><strong>_orientation</strong>    // 设备方向</li>
<li><strong>_online</strong>            // 设备是否联网</li>
<li><strong>_opengl</strong>            // 设备opengl版本</li>
<li><strong>_root</strong>               // 设备是否已越狱</li>
<li><strong>_background</strong>        // 设备是否在后台</li>
<li><strong>_run</strong>               // 应用运行时长</li>
</ul>
</blockquote>
<p>###二、初始化上传数据：</p>
<blockquote>
<ul>
<li><strong>begin_session=1</strong>  // 开始会话</li>
</ul>
</blockquote>
<p>###三、会话心跳数据：<br>时间间隔需确定</p>
<blockquote>
<ul>
<li><strong>session_duration=60</strong>    //  会话与上一次间隔时间：秒</li>
</ul>
</blockquote>
<p>###四、会话结束数据：</p>
<blockquote>
<ul>
<li><strong>end_session=1</strong>        // 会话结束</li>
<li><strong>session_duration</strong>    // 会话与上一次间隔时间：秒</li>
</ul>
</blockquote>
<p>###五、事件：</p>
<blockquote>
<ul>
<li><strong>events =</strong>     // events内容为json对象格式，经过URLEncode，数组格式</li>
<li>{</li>
<li><strong>duration = 123791</strong>    // 持续时间</li>
<li><strong>timestamp</strong>                // 事件发生时的时间戳</li>
<li><strong>count</strong>                    // 发生的次数</li>
<li><strong>sum</strong>                        // 事件的特定值的总和，例如：某次网络请求的流量和</li>
<li><p><strong>key</strong>     </p>
<blockquote>
<pre><code>[JFCLY]_ViewController表示采集的是ViewController的相关信息
[JFCLY]_Control表示采集的是控件的相关信息
[JFCLY]_network表示采集的是网络信息
[JFCLY]_Stutter表示采集的是卡顿信息
[JFCLY]_WebView表示WebView的请求信息
</code></pre></blockquote>
</li>
<li><p><strong>segmentation =</strong> {</p>
<pre><code>// 数据格式根据key来确定，参照下面几种采集方式
</code></pre></li>
<li>}</li>
<li>}</li>
</ul>
</blockquote>
<p>#####5.1、UIViewController信息采集（key = [JFCLY]_ViewController）</p>
<blockquote>
<ul>
<li><strong>segment</strong>             // 系统标识，（iOS、macOS、watchOS、tvOS）</li>
<li><strong>visit</strong>              // 1表示进入ViewController，否则表示退出</li>
<li><strong>name</strong>                // UIViewController类名</li>
<li><strong>start</strong>                // 1表示为根ViewController</li>
<li><strong>function</strong>        // 调用的函数名</li>
<li>==<strong>duration</strong>        // 函数运行耗时（单位：纳秒）==</li>
<li>==<strong>threadID</strong>        // 事件线程ID==</li>
<li>==<strong>threadName</strong>    // 事件线程名==</li>
</ul>
</blockquote>
<p>#####5.2、UIControl信息采集（key = [JFCLY]_Control）</p>
<blockquote>
<ul>
<li><strong>segment</strong>         // 系统标识，（iOS、macOS、watchOS、tvOS）</li>
<li><strong>name</strong>            // 控件类名</li>
<li><strong>target</strong>            // 响应事件的类名</li>
<li><strong>viewController</strong>    // 控件所属的viewController</li>
<li><strong>function</strong>        // 调用的函数名</li>
<li><strong>frame</strong>            // 控件的坐标信息（x, y, width, height）</li>
<li>==<strong>duration</strong>    // 事件响应耗时（单位：纳秒）== </li>
<li>==<strong>threadID</strong>    // 事件线程ID==</li>
<li>==<strong>threadName</strong>    // 事件线程名==</li>
</ul>
</blockquote>
<p>#####5.3、网络信息采集（key = [JFCLY]_network）</p>
<blockquote>
<ul>
<li><strong>segment</strong>             // 系统标识，（iOS、macOS、watchOS、tvOS）</li>
<li><strong>absolute</strong>            // 网络请求的url</li>
<li><strong>statusCode</strong>        // 网络请求的状态码（如果小于0或者大于等于400则为请求出错）</li>
<li>==<strong>statusMsg</strong>        // 网络请求状态描述（statusCode为错误情况时的描述）==</li>
<li>==<strong>stackSymbols</strong>    // 网络出错时的栈信息==</li>
<li><strong>host</strong>                // 网络请求的Host</li>
<li><strong>path</strong>                // 网络请求的path</li>
<li>==<strong>threadID</strong>        // 事件线程ID==</li>
<li><p>==<strong>threadName</strong>    // 事件线程名==</p>
</li>
<li><p><strong>connectionType</strong>    // 网络请求的连接类型：</p>
<blockquote>
<pre><code>0 无连接
1 wifi
2 GPRS
3 2G
4 3G
5 LTE
</code></pre></blockquote>
</li>
</ul>
</blockquote>
<p>#####==5.4、WebView信息采集（key = [JFCLY]_WebView）==</p>
<blockquote>
<ul>
<li><p>==<strong>domain</strong>        // 域名==</p>
</li>
<li><p>==<strong>error_list</strong>    // 错误列表，数组==<br>&gt;</p>
<blockquote>
<pre><code>column = 772;
line = 3;
msg = &quot;SecurityError: DOM Exception 18: An attempt was made to break through the security policy of the user agent.&quot;;
stack = &quot;SecurityError: DOM Exception 18: An attempt was made to break through the security policy of the user agent. at http://m.leju.com/resources/js/dist/app/mLejuV4/index/index.js:3:772&quot;;
time = 1478159318619;
type = SecurityError;
url = &quot;http://m.leju.com/resources/js/dist/app/mLejuV4/index/index.js&quot;;
</code></pre></blockquote>
</li>
<li><p>==<strong>navigationTiming</strong>    // 时间统计信息==<br>&gt;</p>
<pre><code>navigationStart = 1478142703277; // 准备加载新页面的起始时间
redirectStart = 0; // 如果发生了HTTP重定向，并且从导航开始，中间的每次重定向，都和当前文档同域的话，就返回开始重定向的timing.fetchStart的值。其他情况，则返回0
redirectEnd = 0; // 如果发生了HTTP重定向，并且从导航开始，中间的每次重定向，都和当前文档同域的话，就返回最后一次重定向，接收到最后一个字节数据后的那个时间.其他情况则返回0
fetchStart = 1478142703907; // 如果一个新的资源获取被发起，则 fetchStart必须返回用户代理开始检查其相关缓存的那个时间，其他情况则返回开始获取该资源的时间
domainLookupStart = 1478142704525; // 返回用户代理对当前文档所属域进行DNS查询开始的时间。如果此请求没有DNS查询过程，如长连接，资源cache,甚至是本地资源等。 那么就返回 fetchStart的值
domainLookupEnd = 1478142704527; // 返回用户代理对结束对当前文档所属域进行DNS查询的时间。如果此请求没有DNS查询过程，如长连接，资源cache，甚至是本地资源等。那么就返回 fetchStart的值
connectStart = 1478142704528; // 返回用户代理向服务器服务器请求文档，开始建立连接的那个时间，如果此连接是一个长连接，又或者直接从缓存中获取资源（即没有与服务器建立连接）。则返回domainLookupEnd的值
secureConnectionStart = 1478142704580; // 用户代理如果没有对应的东东，就要把这个设置为undefined。如果有这个东东，并且是HTTPS协议，那么就要返回开始SSL握手的那个时间。 如果不是HTTPS， 那么就返回0
connectEnd = 1478142704700; // 返回用户代理向服务器服务器请求文档，建立连接成功后的那个时间，如果此连接是一个长连接，又或者直接从缓存中获取资源（即没有与服务器建立连接）。则返回domainLookupEnd的值
domLoading = 1478142704253; // 返回用户代理把其文档的 &quot;current document readiness&quot; 设置为 &quot;loading&quot;的时候
domInteractive = 1478142705175; // 返回用户代理把其文档的 &quot;current document readiness&quot; 设置为 &quot;interactive&quot;的时候.
domContentLoadedEventStart = 1478142705175; // 返回文档发生 DOMContentLoaded事件的时间
domContentLoadedEventEnd = 1478142705183; // 文档的DOMContentLoaded 事件的结束时间
domComplete = 1478142707714; // 返回用户代理把其文档的 &quot;current document readiness&quot; 设置为 &quot;complete&quot;的时候
loadEventStart = 1478142707714; // 文档触发load事件的时间。如果load事件没有触发，那么该接口就返回0
loadEventEnd = 1478142707912; // 文档触发load事件结束后的时间。如果load事件没有触发，那么该接口就返回0
requestStart = 1478142704219; // 返回从服务器、缓存、本地资源等，开始请求文档的时间
responseEnd = 1478142704248; // 返回用户代理接收到最后一个字符的时间，和当前连接被关闭的时间中，更早的那个。同样，文档可能来自服务器、缓存、或本地资源
responseStart = 1478142704245; // 返回用户代理从服务器、缓存、本地资源中，接收到第一个字节数据的时间
pageTime = 1478142707701;
unloadEventEnd = 0;
unloadEventStart = 0;
</code></pre></li>
<li>==<strong>uri</strong>        // 请求的uri==</li>
<li>==<strong>url</strong>       // 请求的URL==</li>
</ul>
</blockquote>
<p>页面相关时间计算公式：<br>==<strong>DNS查询耗时 ：domainLookupEnd - domainLookupStart<br>TCP链接耗时 ：connectEnd - connectStart<br>request请求耗时 ：responseEnd - responseStart<br>解析dom树耗时 ： domComplete- domInteractive<br>白屏时间 ：responseStart - navigationStart<br>domready时间 ：domContentLoadedEventEnd - navigationStart<br>页面耗时 ：pageTime - navigationStart<br>onload时间 ：loadEventEnd - navigationStart</strong>==</p>
<p>#####5.4、卡顿信息采集（key = [JFCLY]_Stutter）当卡顿时间超过150ms时采集</p>
<blockquote>
<ul>
<li><strong>name</strong>        // 卡顿</li>
<li><strong>segment</strong>     // 系统标识，（iOS、macOS、watchOS、tvOS)</li>
<li><strong>stutter</strong>     // 卡顿时所有线程的栈信息</li>
</ul>
</blockquote>
<p>###六、崩溃信息：</p>
<blockquote>
<ul>
<li><strong>crash =</strong> // crash为json对象，经过URLEncode</li>
<li>{</li>
<li><strong>_os</strong>                   // 系统名</li>
<li><strong>_os_version</strong>        // 系统版本</li>
<li><strong>_device</strong>            // 设备型号</li>
<li><strong>_resolution</strong>        // 分辨率</li>
<li><strong>_app_version</strong>     // 应用版本号</li>
<li><strong>_app_build</strong>          // 应用编译版本号</li>
<li><strong>_build_uuid</strong>         // 编译UUID</li>
<li><strong>_name</strong>                // 异常的描述</li>
<li><strong>_nonfatal</strong>            // 是否是系统抛出的崩溃信息，true不是，false是</li>
<li><strong>_density</strong>            // 屏幕缩放比例</li>
<li><strong>_carrier</strong>            // 运营商</li>
<li>==<strong>_locale</strong>            // 系统语言==</li>
<li>==<strong>_ip</strong>                // 设备IP地址==</li>
<li>==<strong>_gps</strong>                // 设备GPS经纬度，格式(latitude,longitude)==</li>
<li><strong>_cpu_current</strong>   // 当前的CPU使用率</li>
<li><strong>_ram_current</strong>     // 当前的ram空间</li>
<li><strong>_ram_total</strong>        // 设备ram总大小</li>
<li><strong>_disk_current</strong>    // 当前设备磁盘空间</li>
<li><strong>_disk_total</strong>        // 当前设备磁盘总大小</li>
<li><strong>_bat</strong>               // 设备电量</li>
<li><strong>_orientation</strong>    // 设备方向</li>
<li><strong>_online</strong>            // 设备是否联网</li>
<li><strong>_opengl</strong>            // 设备opengl版本</li>
<li><strong>_root</strong>               // 设备是否已越狱</li>
<li><strong>_background</strong>        // 设备是否在后台</li>
<li><strong>_run</strong>            // 应用运行时长</li>
<li><strong>_logs</strong>            // 日志</li>
<li><strong>_error</strong>            // 奔溃错误栈信息</li>
<li>}    </li>
</ul>
</blockquote>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/11/08/iOS数据采集/" class="archive-article-date">
  	<time datetime="2016-11-08T05:28:14.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-11-08</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS/">iOS</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
  
    <a href="/2016/11/08/免费视频解析接口/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">免费视频解析接口</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>











      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Gengjf
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a>
      	</div>
    </div>
  </div>
</footer>

    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    

    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">很懒，暂时没写</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>